---           
layout: post
title: How to replace text with images on Word documents using C#
date: 2013-08-29 12:12:03 UTC
updated: 2013-08-29 12:12:03 UTC
comments: false
categories: How To Office Interop
---
<div class="MsoNormal">This post it’s a reply to a question I got from a previous post that shows <a href="http://alemiralles.blogspot.com.ar/2012/11/how-to-create-word-documents-from.html" target="_blank">how to work with Word templates from C# code</a>. If you haven’t read it, I recommend to do so because I’m not going into details here. But basically it was about how to create a Word document from a template and perform same text manipulation.<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal">So, the question from <a href="http://www.blogger.com/profile/02164177296142012589" target="_blank">Marcel Kieboom</a>&nbsp;was <br /><b>“Do you know if it would be also possible to replace one of the words with an image which is locally stored?”</b><o:p></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal">The answer is yes, and this is how you can do that.<o:p></o:p><br /><br /></div><div class="MsoNormal">Based on the same convention I had used in the previous post, I should have a template like this:</div><div class="MsoNormal"><br /></div><div class="separator" style="clear: both; text-align: center;"></div><div class="MsoNormal"><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-pmQl8pcn76U/Uhz3qEdygTI/AAAAAAAAAiQ/3NFsmZa1ctU/s1600/template.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-pmQl8pcn76U/Uhz3qEdygTI/AAAAAAAAAiQ/3NFsmZa1ctU/s1600/template.png" /></a></div><br /></div><div class="MsoNormal"><br /></div><div class="MsoNormal">What I’m trying to do here is replace the text [angus-young] for an actual pic of Angus. The technique I’m using it’s pretty common on web sites and basically consist in have an image with a matching name for each keyword I want to replace and then create the image path dynamically.<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal">This is the C# code to do that.<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-6Aj2Dfhfroc/Uhz2N7YT1RI/AAAAAAAAAiE/fjAb7XuH97U/s1600/c-sharp-code.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-6Aj2Dfhfroc/Uhz2N7YT1RI/AAAAAAAAAiE/fjAb7XuH97U/s1600/c-sharp-code.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="MsoNormal">* When I execute the find operation I’m using the flag WdReplace.wdReplaceNone. This is important because otherwise we will messed up the current selection and the image will be inserted in the wrong place.<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal">Once you run the code, you will be creating a document called foo.docx inside the bin/debug/docs folder which should look something like this:&nbsp;<o:p></o:p></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-vL8gxH1qRV0/Uhz4g6QdTrI/AAAAAAAAAig/ZK4ejm0Yzg0/s1600/result.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-vL8gxH1qRV0/Uhz4g6QdTrI/AAAAAAAAAig/ZK4ejm0Yzg0/s1600/result.png" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"></div><div class="MsoNormal"><br /></div><div class="MsoNormal">You can grab the code from <a href="https://github.com/amiralles/How-to-replace-text-with-images-on-word-documents-using-c-sharp" target="_blank">github</a>. And as usual, questions are more than welcome. Please ping me if you have any trouble using this code.<o:p></o:p></div>