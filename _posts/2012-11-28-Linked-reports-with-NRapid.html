---           
layout: post
title: Linked reports with NRapid
date: 2012-11-28 15:10:44 UTC
updated: 2012-11-28 15:10:44 UTC
comments: false
categories: How To NRapid Reporting
---
<span style="background-color: white;">Being able to link reports it’s really handy feature that usually the end users of our system will love it.</span><br /><div class="MsoNormal"><span lang="EN-US">For instance, you can create a report that that displays order’s headers and when the users click on the order’s id, he/she can see a child report with the order’s detail.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">In this case I’m going to work with categories and products but the technique can be applied to any master-detail scenario. <o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">First of all we need to create a report that shows the list of categories (we already did that in a previous post, so I’m not going into details here) and then somehow link this report with a report that show a list products for a specific category.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">This might sound complex, but with NRapid is pretty straightforwa</span><span style="background-color: white;">rd and only will take you just a line of code inside the configure method:</span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-JYJD9vi9ZMw/T_fCG6u4kSI/AAAAAAAAAHs/7eyhiFMkgSk/s1600/codigo-add-link.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-JYJD9vi9ZMw/T_fCG6u4kSI/AAAAAAAAAHs/7eyhiFMkgSk/s1600/codigo-add-link.png" /></a></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">*There’s also a cool feature inside NRapid reports that allows us to run arbitrary c# code when the user clicks a link but this feature deserves his own post ;)<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">What does this code does, well, basically it tells to the report engine that the cells inside the column “Cat. Id” are special and must associate callbacks to them, this will give us the ability to handle the user click.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">If you execute the report, you will see that now the category’s ids are links not plain text.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-EN746aJuULs/T_fCdI_opoI/AAAAAAAAAH0/Glve3OEtvPw/s1600/show-master.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="366" src="http://2.bp.blogspot.com/-EN746aJuULs/T_fCdI_opoI/AAAAAAAAAH0/Glve3OEtvPw/s640/show-master.png" width="640" /></a></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"></div><div class="MsoNormal"><span lang="EN-US">In our case, those links (callbacks) will being pointing to the method <b>ShowProductsByCategory</b>wich we will be using to execute the child report (in this case, products by category). The code to do that may look something like this:</span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-grOhAqYN7CU/T_fC6gv4ZAI/AAAAAAAAAH8/otbAVoFcLrg/s1600/callback.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-grOhAqYN7CU/T_fC6gv4ZAI/AAAAAAAAAH8/otbAVoFcLrg/s1600/callback.png" /></a></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><br /><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><span lang="EN-US">If you take a look at the code, you’ll see that category’s Id was magically passed to our callback method. In future posts I’ll be covering some of the internals of NRapid and we will take a deep dive into those kinds of tricks.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">When you run the report, you should see something like this:<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="separator" style="clear: both; text-align: center;"></div><div class="MsoNormal"><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-SVzOaXNIYGs/T_fDKJG5lTI/AAAAAAAAAIE/-YlKdJyjCU4/s1600/show-master-and-detail.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-SVzOaXNIYGs/T_fDKJG5lTI/AAAAAAAAAIE/-YlKdJyjCU4/s1600/show-master-and-detail.png" /></a></div><div class="separator" style="clear: both; text-align: left;"><span style="background-color: white;">In the next post I'll show you how to add footers to our reports.</span></div><span style="background-color: white;"><br /></span><span style="background-color: white;">You can get the source code of NRapid from&nbsp;</span><a href="https://xp-dev.com/svn/NRapid/" style="background-color: white;" target="_blank">here</a><br /><div class="MsoNormal"><span lang="EN-US"><span lang="EN-US">And the sample app from&nbsp;<a href="https://xp-dev.com/svn/nrapid-reports-learn/" target="_blank">here</a></span></span></div><div class="MsoNormal"><span lang="EN-US"><span lang="EN-US">The Northwind database is available from download at&nbsp;<a href="http://www.microsoft.com/en-us/download/details.aspx?id=23654" target="_blank">http://www.microsoft.com/en-us/download/details.aspx?id=23654</a></span></span></div></div>