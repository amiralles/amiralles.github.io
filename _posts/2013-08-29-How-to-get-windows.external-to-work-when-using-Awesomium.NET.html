---           
layout: post
title: How to get windows.external to work when using Awesomium.NET
date: 2013-08-29 16:22:39 UTC
updated: 2013-08-29 16:22:39 UTC
comments: false
categories: Awesomium.NET C#
---
<b style="background-color: yellow;">Note: There is an updated version of this post <a href="http://www.alemiralles.blogspot.com.ar/2013/08/how-to-get-windowsexternal-to-work-when.html">right here</a>&nbsp;(with source code and all stuff)</b><br /><br /><div class="MsoNormal"><span lang="EN-US">I been doing some experiments with the <a href="http://awesomium.com/" target="_blank">Awesomium</a>&nbsp;web browser framework, and after a lot of failing attempts, I finally got windows.external calls working.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"></span></div><div class="MsoNormal"><span lang="EN-US"><a href="http://awesomium.com/" target="_blank">Awesomium</a>&nbsp;is a windowless port of Chromium/WebKit. For WinForm developers,&nbsp;an alternative way to embed web pages in your winforms or WPF apps without having to use the WebBrowser control.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">For a long time, I been using the IE embedded browser to show reports (webpages) in winform apps, with let sayâ€¦, acceptable results ;), but the thruth is there is a lot of goodness out there into the wild with better support for css, html 5, etc. So I decided to install Awesomium.NET and give it a try.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">While the API is pretty intuitive, I had some trouble trying to call C# methods from Javascript, a fairly easy thing to do with the classic webbrowser control.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"></div><div class="MsoNormal"><span lang="EN-US"><b>This is how things work when using embedded IE Browser</b><o:p></o:p></span></div><div class="MsoNormal"><br /></div><div class="MsoNormal">C# code</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-g6vclZembtQ/UP25stqiDBI/AAAAAAAAAeQ/g_8ExFRyAE0/s1600/_obj-for-scripting.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-g6vclZembtQ/UP25stqiDBI/AAAAAAAAAeQ/g_8ExFRyAE0/s1600/_obj-for-scripting.png" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-JbRo4jwuv9Y/UP25ptigpRI/AAAAAAAAAeI/AEWlr0a2mL8/s1600/_obj-for-call.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-JbRo4jwuv9Y/UP25ptigpRI/AAAAAAAAAeI/AEWlr0a2mL8/s1600/_obj-for-call.png" /></a></div><div class="separator" style="clear: both; text-align: left;">html code</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-qAR9kX_8UwA/UP253UzIWWI/AAAAAAAAAeY/3I4EbPwfSQo/s1600/_calling-from-js.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-qAR9kX_8UwA/UP253UzIWWI/AAAAAAAAAeY/3I4EbPwfSQo/s1600/_calling-from-js.png" /></a></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><b><br /></b></span></div><div class="MsoNormal"><span lang="EN-US"><b>And this is how to do it when using Awesomium.NET.</b><o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">C# code</span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-4k7JO-VUuFE/UP26HtlmRSI/AAAAAAAAAeg/Tk6rsnujLzI/s1600/binding-global-object.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="306" src="http://3.bp.blogspot.com/-4k7JO-VUuFE/UP26HtlmRSI/AAAAAAAAAeg/Tk6rsnujLzI/s640/binding-global-object.png" width="640" /></a></div><div class="MsoNormal"><span lang="EN-US">Html code</span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-ljL041sR7ec/UP26PWke-UI/AAAAAAAAAeo/DnSmm_rrb_A/s1600/calling-global-object.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-ljL041sR7ec/UP26PWke-UI/AAAAAAAAAeo/DnSmm_rrb_A/s1600/calling-global-object.png" /></a></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"></span></div><div class="MsoNormal"><span lang="EN-US">Aside for this pitfall, this framework is great, it is easy to use, well documented and it comes with a bunch of working samples (for both, WinForms and WPF apps). Highly recommendable.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">In this post I'm using Awesomium 1.7.0 RC3. I know the API has change from previous releases and were a lot of bug fixes (some of them related to javascript interop). If you are running on a previous version of the framework, the code seen above may not work.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><br /><br /><br />