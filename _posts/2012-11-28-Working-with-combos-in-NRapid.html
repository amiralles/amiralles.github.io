---           
layout: post
title: Working with combos in NRapid
date: 2012-11-28 15:11:40 UTC
updated: 2012-11-28 15:11:40 UTC
comments: false
categories: How To NRapid Reporting
---
<br /><div class="MsoNormal"><span lang="EN-US">I think that working with combos is the most complex thing that you can do with NRapid, they are hard to configure and requires a lot of plumbing code, but they are really handy when you have to work with fixed sets of options.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">This time I’m going to build a report that shows some employees info. The report’s dialog will allows us to filter that info based on the employees city and get smaller result sets. Cities are a fixed set of data(at least in Northwind) so combos will be a nice choice.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US">In order to get a combo, we need to add to properties to the nested dialog. Those properties will work together to make selection works.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">The code may look something like this:<o:p></o:p></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-MlOZe8qgW_I/T_sVgA22yzI/AAAAAAAAAJg/SVVIVlOdPIc/s1600/properties-to-get-a-combo.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-MlOZe8qgW_I/T_sVgA22yzI/AAAAAAAAAJg/SVVIVlOdPIc/s1600/properties-to-get-a-combo.png" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="MsoNormal"><span lang="EN-US">Notice that City is annotated with the <b>ViewIgnore</b> attribute, this is the way to tell to engine <b>"do not create a control for this property"</b>. And Cities is annotated with the <b>DispalyOptionsFor</b> attribute pointing to City, this means that the selected option in the combo will be used to set the value of the City property.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">Now that we have those properties hooked up, we need to populate the list with the fixed set of options. I usually do this in the dialog constructor.<o:p></o:p></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-8yDhK2tbsFE/T_sV8185rjI/AAAAAAAAAJw/cu07saM0oME/s1600/dialog-ctor.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-8yDhK2tbsFE/T_sV8185rjI/AAAAAAAAAJw/cu07saM0oME/s1600/dialog-ctor.png" /></a></div><div class="MsoNormal"><span style="background-color: white;">Something important to know is that when we’re getting the selected City from the combo options, we’ve to ask for the Cities property (and not for the one that we use to store the selection)</span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-6-KLWQPmCd8/T_sWoJkrG5I/AAAAAAAAAJ4/uioZo91OoaQ/s1600/configure-report.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-6-KLWQPmCd8/T_sWoJkrG5I/AAAAAAAAAJ4/uioZo91OoaQ/s1600/configure-report.png" /></a></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><span style="background-color: white;">When you execute the report you will get a dialog like this:</span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-17Sn_a5_OKk/T_sVf_oq_SI/AAAAAAAAAJY/YjWvlVfLUR4/s1600/dialog-at-run-time.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-17Sn_a5_OKk/T_sVf_oq_SI/AAAAAAAAAJY/YjWvlVfLUR4/s1600/dialog-at-run-time.png" /></a></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><span lang="EN-US">And then when you confirm the dialog you will get the employees info filtered by city.(In this case London)<o:p></o:p></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-995G-eTMaI8/T_sVg6jIc9I/AAAAAAAAAJo/Fjnf6bPQ-jA/s1600/report-at-run-time.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-995G-eTMaI8/T_sVg6jIc9I/AAAAAAAAAJo/Fjnf6bPQ-jA/s1600/report-at-run-time.png" /></a></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><span lang="EN-US">So that's it for combos. In the next post I’ll show you how to work with autocompletes.<o:p></o:p></span><br /><span lang="EN-US"></span><br /><span lang="EN-US"><span style="background-color: white;"><span style="background-color: white;"><br /></span></span></span><span lang="EN-US"><span style="background-color: white;"><span style="background-color: white;">You can get the source code of NRapid from&nbsp;</span><a href="https://xp-dev.com/svn/NRapid/" style="background-color: white;" target="_blank">here</a></span></span><br /><div class="MsoNormal"><span lang="EN-US"><span style="background-color: white;"><span lang="EN-US"><span lang="EN-US">And the sample app from&nbsp;<a href="https://xp-dev.com/svn/nrapid-reports-learn/" target="_blank">here</a></span></span></span></span></div><div class="MsoNormal"><span lang="EN-US"><span style="background-color: white;"><span lang="EN-US"><span lang="EN-US">The Northwind database is available from download at&nbsp;<a href="http://www.microsoft.com/en-us/download/details.aspx?id=23654" target="_blank">http://www.microsoft.com/en-us/download/details.aspx?id=23654</a></span></span></span></span></div></div>