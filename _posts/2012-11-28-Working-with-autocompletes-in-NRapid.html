---           
layout: post
title: Working with autocompletes in NRapid
date: 2012-11-28 15:12:13 UTC
updated: 2012-11-28 15:12:13 UTC
comments: false
categories: How To NRapid Reporting
---
<br /><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span lang="EN-US"><span style="font-family: Calibri;">One of the main goals behind relational databases design is reduce/eliminate the amount of duplicated data. In order to do that, they split the data into multiple tables and relate them by FK. While this works really well in database terms, they don’t when it comes to searching or loading data (In highly normalized database we usually need a lot of JOINs)<o:p></o:p></span></span></div><span lang="EN-US"><span style="font-family: Calibri;">Continuing with an example that we were working on previous posts (<strong>products by category</strong>) we can see this design lines in action.</span></span><br /><div class="separator" style="clear: both; text-align: center;"><img border="0" src="http://3.bp.blogspot.com/-rp-78joysOs/T_1y0BNt7JI/AAAAAAAAAKE/1nQUoifnBdQ/s1600/der.png" />﻿</div><div align="left" class="separator" style="clear: both; text-align: center;"></div><br /><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span lang="EN-US"><span style="font-family: Calibri;">The goal of our report is allow the users to select a category, and based on that category, fetch the corresponding list of products. The problem is, <strong>if we look at the products table, the product's&nbsp;category is and ID (numeric), which is hard to remember and does not&nbsp;make any sense on his own</strong>. In this kind of scenarios, we can use the <strong>autocomplete control</strong>. This control will allows to the user to filter by description (category name) or any field that make sense to him/her and pass to the report engine the corresponding ID to filter the relational data (in this case, the category ID).<o:p></o:p></span></span></div><span lang="EN-US"><span style="font-family: Calibri;">To get an autocomplete in our dialog, we need to define a class that looks something like this:</span></span><a href="http://1.bp.blogspot.com/-aWOe_ytNlgY/T_1zTkjfKqI/AAAAAAAAAKM/k9uHnC1w-1o/s1600/Autocomple-class.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-aWOe_ytNlgY/T_1zTkjfKqI/AAAAAAAAAKM/k9uHnC1w-1o/s1600/Autocomple-class.png" /></a><br /><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"></div><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span lang="EN-US"><span style="font-family: Calibri;">* Annotations are required because we are working with a "legacy database” wich does not follow the NRapid conventions, more on this in future posts.<o:p></o:p></span></span></div><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span lang="EN-US"><span style="font-family: Calibri;">As you may already guess, <strong>CategoryName</strong> is the field that we are going to use to provide some sort of searching feature, and <strong>CategoryID</strong> is the field we will use to query the database.<o:p></o:p></span></span></div><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span lang="EN-US"><span style="font-family: Calibri;">Ones this class is done, we only need to add a property to the nested class “Dialog” (seen in previous posts) and <strong>NRapid</strong> will take cares of the rest.</span></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-WgvUxrDMn_c/T_103oU4g-I/AAAAAAAAAKs/0Bi2_DSgXvA/s1600/dialog-class.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-WgvUxrDMn_c/T_103oU4g-I/AAAAAAAAAKs/0Bi2_DSgXvA/s1600/dialog-class.png" /></a></div><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><br /></div><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span lang="EN-US"><span style="font-family: Calibri;"><o:p><span lang="EN-US">The code to configure the report should look something like this (note that in the<strong> view data we are getting the Category ID</strong>)<o:p></o:p></span></o:p></span></span></div><span style="font-family: Calibri;"></span><br /><span style="font-family: Calibri;"></span><br /><span style="font-family: Calibri;"></span><br /><div class="separator" style="clear: both; text-align: center;"><span style="font-family: Calibri;"><a href="http://3.bp.blogspot.com/-REnj1RFYhao/T_10Cn7k3NI/AAAAAAAAAKU/skHdtFZkZUo/s1600/configure-report-method.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-REnj1RFYhao/T_10Cn7k3NI/AAAAAAAAAKU/skHdtFZkZUo/s1600/configure-report-method.png" /></a></span></div><span style="font-family: Calibri;"></span><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-family: Calibri;"><span style="font-family: 'Times New Roman';">   <span lang="EN-US"><span style="font-family: Calibri;">When executing the report, you will see a textbox labeled “category”, <strong>pressing F2</strong>will a show a list of categories, select one and confirm the dialog.<o:p></o:p></span></span></span></span></div><span style="font-family: Calibri;"><span style="font-family: 'Times New Roman';"><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-eyHJKVEDytw/T_10PqmRoXI/AAAAAAAAAKc/AjPoKz4YMUM/s1600/autocomplete-at-runtime.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-eyHJKVEDytw/T_10PqmRoXI/AAAAAAAAAKc/AjPoKz4YMUM/s1600/autocomplete-at-runtime.png" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-TH5SNahKeEU/T_10U_iQ1FI/AAAAAAAAAKk/QS1hIm6NKI0/s1600/report-layout.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://1.bp.blogspot.com/-TH5SNahKeEU/T_10U_iQ1FI/AAAAAAAAAKk/QS1hIm6NKI0/s320/report-layout.png" width="318" /></a></div><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"></div><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><br /></div><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span lang="EN-US"><span style="font-family: Calibri;">On the next post, customizing autocompletes. Stay tuned!</span></span></div></span><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"></div></span><br /><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span lang="EN-US"><span style="background-color: white;"><span style="background-color: white;">You can get the source code of NRapid from </span><a href="https://xp-dev.com/svn/NRapid/" style="background-color: white;" target="_blank">here</a></span></span></div><div class="MsoNormal"><span lang="EN-US"><span style="background-color: white;"><span lang="EN-US"><span lang="EN-US">And the sample app from <a href="https://xp-dev.com/svn/nrapid-reports-learn/" target="_blank">here</a></span></span></span></span></div><div class="MsoNormal"><span lang="EN-US"><span style="background-color: white;"><span lang="EN-US"><span lang="EN-US">The Northwind database is available from download at <a href="http://www.microsoft.com/en-us/download/details.aspx?id=23654" target="_blank">http://www.microsoft.com/en-us/download/details.aspx?id=23654</a></span></span></span></span></div><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"></div><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"></div><div class="separator" style="clear: both; text-align: center;"><br /></div>