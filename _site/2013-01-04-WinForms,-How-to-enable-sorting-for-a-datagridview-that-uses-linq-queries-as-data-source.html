---           
layout: post
title: WinForms, How to enable sorting for a datagridview that uses linq queries as data source 
date: 2013-01-04 21:53:36 UTC
updated: 2013-01-04 21:53:36 UTC
comments: false
categories: C# DataGridView WinForms
---
<br /><div class="MsoNormal"><span lang="EN-US">How to enable sorting for a datagridview that uses linq queries as data source it is a frequently asked question on the web. The short answer is you cannot, but let dig a little deeper.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><b>Why the sorting functionality works as expected when you use it on a grid binded to a DataTable and miserably fails when you bind it to an IEnumerable&lt;DataRow&gt;?&nbsp;</b></span><br /><span lang="EN-US">A bit of research later… Easy, the DataTable class provides its own implementation for sorting rows whereas IEnumrable&lt;T&gt; does not.</span><br /><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">I faced this problem building the power grid control, because (to make paging records easy) internally I was using linq queries. As soon as I realized that the datagrid sorting was broken, I started to look on the web an easy way to solve this problem (other than implement my own sorting mechanisms, of course). I found a couple of alternatives but <a href="http://www.timvw.be/2008/08/02/presenting-the-sortablebindinglistt-take-two/" target="_blank">this one</a>&nbsp;convinced me.</span><br /><span lang="EN-US"><br /></span> <span lang="EN-US"></span><br /><div class="MsoNormal"><span lang="EN-US"><span lang="EN-US">This class has a neat way to solve generic sorting with a minimal impact on performance. I’ve tested it sorting pages containing 1K+ records and it’s a breeze.<o:p></o:p></span></span></div><span lang="EN-US"> </span><br /><div class="MsoNormal"><span lang="EN-US"><span lang="EN-US"><br /></span></span></div><span lang="EN-US"></span><br /><div class="MsoNormal"><span lang="EN-US"><span lang="EN-US">This is how I use it.<o:p></o:p></span></span></div><span lang="EN-US"></span><div class="MsoNormal"><span lang="EN-US"><span lang="EN-US"><br /></span></span></div><span lang="EN-US"><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-WV68Zv-Pvr8/UOdLUr1-fkI/AAAAAAAAAdk/i7zrPRtt6i0/s1600/using-sorteable.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-WV68Zv-Pvr8/UOdLUr1-fkI/AAAAAAAAAdk/i7zrPRtt6i0/s1600/using-sorteable.png" /></a></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">As you can see, instead of binding the query result directly to the datagrid, I'm wrapping it into a SortableBindingList first and then performing data binding.</span><br /><span lang="EN-US"><br /></span><span lang="EN-US">Finally, the sorting functionality works as expected ;)</span><br /><span lang="EN-US"><br /></span><span lang="EN-US">You can get the code from&nbsp;<a href="https://github.com/amiralles/powergrid" target="_blank">here</a></span></div>