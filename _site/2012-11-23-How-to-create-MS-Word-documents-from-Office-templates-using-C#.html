---           
layout: post
title: How to create MS Word documents from Office templates using C#
date: 2012-11-23 16:35:45 UTC
updated: 2012-11-23 16:35:45 UTC
comments: false
categories: C# How To Office Interop
---
<br /><div class="MsoNormal"><span lang="EN-US">The OpenXML SDK allows you to do pretty much anything you want with office files such as Excel, Word, etc… While many people like this library, I found it complex, unintuitive and poorly documented, not to mention the awful xml format that uses under the hood to represent the documents, styles, etc. So I decided not to use it and build my own solution. If you, like me, don’t like that library, you will find in this post an alternative approach to build word documents from templates using c#.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">A neat trick to work with Office is to use the macro recorder to understand how things work. The macro recorder allows you to start a macro, do something by hand, stop it, and then take a look at the generated VBA code. Once you do this, you are pretty much set.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">This is how it looks the template I’am going to use.<o:p></o:p></span></div><div class="MsoNormal"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-FQHrkHQZa0M/UK-ecP4jMGI/AAAAAAAAAWQ/psrGlQkEGow/s1600/the-template.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-FQHrkHQZa0M/UK-ecP4jMGI/AAAAAAAAAWQ/psrGlQkEGow/s1600/the-template.png" /></a></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><span lang="EN-US"><b>Note: save the file as a Word template (.dotx)</b><o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">This is the code to create Word documents from C#:<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-PFTa0ZibNEI/UK-ekJkDScI/AAAAAAAAAWY/bHQgKYeGidI/s1600/the-code.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-PFTa0ZibNEI/UK-ekJkDScI/AAAAAAAAAWY/bHQgKYeGidI/s1600/the-code.png" /></a></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><span lang="EN-US">By running the code, you should get a document that looks like this.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-6Zn793TaMz4/UK-etbhHJ_I/AAAAAAAAAWg/uwkQ20u1pVQ/s1600/result.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-6Zn793TaMz4/UK-etbhHJ_I/AAAAAAAAAWg/uwkQ20u1pVQ/s1600/result.png" /></a></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">Note that the font, format, styles, etc. are the same that we defined in the template (Is not just about replacing text)<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">By the way, don't forget to reference the right version Word interop assembly.</span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-mAtQPNFXVNU/UK-f6M7CbvI/AAAAAAAAAWo/VAutvGrnmLI/s1600/add-reference.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="132" src="http://4.bp.blogspot.com/-mAtQPNFXVNU/UK-f6M7CbvI/AAAAAAAAAWo/VAutvGrnmLI/s400/add-reference.png" width="400" /></a></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">You can grab the code from <a href="https://github.com/amiralles/how-to-create-word-documents-from-office-templates-using-csharp" target="_blank">here</a>&nbsp;&nbsp;<o:p></o:p></span></div>