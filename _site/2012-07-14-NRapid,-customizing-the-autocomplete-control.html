---           
layout: post
title: NRapid, customizing the autocomplete control
date: 2012-07-14 20:21:43 UTC
updated: 2012-07-14 20:21:43 UTC
comments: false
categories: Hacking How To NRapid
---
<br /><div class="MsoNormal"><span lang="EN-US">A while ago I got a question about the autocomplete control, <b>“it’s possible to use records coming from different tables as an autocomplete data source?”</b><o:p></o:p></span></div><div class="MsoNormal"></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">The answer is yes, It’s possible, but requires a bit of configuration.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">The use case was simple, but does not fit into the NRapid default feature set. By default, autocompletes work with a data source that contains just two columns, the <b>record id</b> and a <b>description field</b> (which is used to filter records). <b>Those two columns must come from the same table</b>. In this case, the user wants to see additional columns coming from different tables, so the solution requires a bit of hacking.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">I’ll show you how to do this, by combining two tables, products and categories. Basically I’ll add the category name (from Categories) to the products autocomplete data source (which by default just has the product id and the product name, both coming from the products table).<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">To make this thing work, we need to use the<b>&nbsp;customization feature</b>, the code should look something like this:<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-Nl9Nd-F7iRU/UAGqFO3SVzI/AAAAAAAAALM/pg1VNK6khC4/s1600/customize-autocompletes.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-Nl9Nd-F7iRU/UAGqFO3SVzI/AAAAAAAAALM/pg1VNK6khC4/s1600/customize-autocompletes.png" /></a></div><span style="background-color: white; text-align: left;">Note that </span><b style="background-color: white; text-align: left;">the code was placed inside the report’s constructor</b><span style="background-color: white; text-align: left;">. This has to be done this way,</span><b style="background-color: white; text-align: left;">because the code must be executed as soon as possible</b><span style="background-color: white; text-align: left;"> to override the NRapid default behavior. (If you put this code somewhere else, it just ain’t gonna work)</span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">* I’m not showing how to add an autocomplete control to the dialog because was covered in a previous post.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">Now execute the report, hit F2 in the textbox labeled <b>Product</b> and you will see an autocomplete with three columns coming from two different tables.<o:p></o:p></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-53pZRwEL9PY/T_2YlpzU9gI/AAAAAAAAALA/Rf01rXaC0fI/s1600/autocomplete-at-run-time.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-53pZRwEL9PY/T_2YlpzU9gI/AAAAAAAAALA/Rf01rXaC0fI/s1600/autocomplete-at-run-time.png" /></a></div><div class="MsoNormal"><br /></div><br /><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span lang="EN-US"><span style="background-color: white;"><span style="background-color: white;">You can get the source code of NRapid from&nbsp;</span><a href="https://xp-dev.com/svn/NRapid/" style="background-color: white;" target="_blank">here</a></span></span></div><div class="MsoNormal"><span lang="EN-US"><span style="background-color: white;"><span lang="EN-US"><span lang="EN-US">And the sample app from&nbsp;<a href="https://xp-dev.com/svn/nrapid-reports-learn/" target="_blank">here</a></span></span></span></span></div><div class="MsoNormal"><span lang="EN-US"><span style="background-color: white;"><span lang="EN-US"><span lang="EN-US">The Northwind database is available from download at&nbsp;<a href="http://www.microsoft.com/en-us/download/details.aspx?id=23654" target="_blank">http://www.microsoft.com/en-us/download/details.aspx?id=23654</a></span></span></span></span></div>