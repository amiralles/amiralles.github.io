---           
layout: post
title: Migrating an ASP.NET MVC 4 app from Azure websites to WinHost
date: 2012-11-24 13:30:44 UTC
updated: 2012-11-24 13:30:44 UTC
comments: false
categories: ASP.NET MVC 4
---
<br /><div class="MsoNormal"><span lang="EN-US">About a week ago I've to migrate an <b>ASP.NET MVC 4/EF5</b> application from Azure websites to WinHost. While the process was really smooth, there were some caveats related to database connections that I want to share with you.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">Create and setup the ftp profile on VS and configure the connection string was really easy, WinHost provide you those values and there is nothing special here. But once you deploy your website and try to see it online, you may get the “yellow screen of dead” with the message:<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><blockquote class="tr_bq"><span lang="EN-US">"A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)"</span></blockquote><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">Assuming you wrote the connection string properly, this happens because <b>you cannot use the default connection name in your web.config file</b> (this works on Azure websites). <b>You have to explicitly specify a connection name that matches to your DbContext</b>. Once you do that, your DbContext will be able to connect to the database but is going to fail trying to initialize.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">The thing is you don’t have admin privileges on WinHost database servers, so there is no way to create your tables (or drop/create, or whatever the strategy you’re using) from your DbContext. Once again, this works fine on Azure websites but you have to do a little work to get it up and running on WinHost. <b>The workaround here is create the database in your development machine, make a backup, and restore it on WinHost using the online administration tool </b>(This is the only way you can backup/restore your databases on WinHost, don’t try with SSMS, VS, or anything else, they ain’t gonna work)<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US"></span></div><div class="MsoNormal"><span lang="EN-US">So far, those are the issues I found. If I find something else I'll be posting it here.</span></div><div class="MsoNormal">Hope this helps.</div><o:p></o:p><br /><br />