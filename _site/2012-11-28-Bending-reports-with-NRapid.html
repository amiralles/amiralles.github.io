---           
layout: post
title: Bending reports with NRapid
date: 2012-11-28 15:11:09 UTC
updated: 2012-11-28 15:11:09 UTC
comments: false
categories: How To NRapid
---
In a previous post we saw how to override report’s default format using the SetRawStyle extension method. This allows us to modify the layout and do quick fixes without touching style sheet. That’s quite handy, but if you have to add a lot of format your code will end up looking messy.<br /><br />In this post I’ll work with a shipping report and show you how to bend reports using the NRapid’s fluent API. So let get started.<br /><br /><br /><div class="MsoNormal"><span lang="EN-US">This is the first draft<o:p></o:p></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-N4CZcmsOoOQ/UC7HLqVmSoI/AAAAAAAAAS8/ibxxvQniZF8/s1600/code-step-1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-N4CZcmsOoOQ/UC7HLqVmSoI/AAAAAAAAAS8/ibxxvQniZF8/s1600/code-step-1.png" /></a></div><div class="MsoNormal"><span lang="EN-US">And the output should look something like this:</span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-yJ8biH0iaLw/UC7HOZ4Z0RI/AAAAAAAAATc/cYLrVyGLs2Y/s1600/step-1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-yJ8biH0iaLw/UC7HOZ4Z0RI/AAAAAAAAATc/cYLrVyGLs2Y/s1600/step-1.png" /></a></div><div class="MsoNormal"><span lang="EN-US"></span></div><div class="MsoNormal"><span lang="EN-US">As you can see we have some sort of shipping info of customer's orders. I don’t know if I've covered how to add footers in previous posts, I’ll check on that later and if I didn’t, I will. But for now, let just concentrate on formatting only.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">First of all I don’t like the way the footer is formatted by default. I cannot see the difference between footers and standard rows, so I’m gonna format the footer’s text to bold, just for start.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-xLAg8-VfUD4/UC7HMeygqPI/AAAAAAAAATE/90yEonWiPgI/s1600/code-step-2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-xLAg8-VfUD4/UC7HMeygqPI/AAAAAAAAATE/90yEonWiPgI/s1600/code-step-2.png" /></a></div><div class="MsoNormal">Now this is the output:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-MDafFUtP07Q/UC7HPXY2P-I/AAAAAAAAATk/2y5FWT-7zh4/s1600/step-2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-MDafFUtP07Q/UC7HPXY2P-I/AAAAAAAAATk/2y5FWT-7zh4/s1600/step-2.png" /></a></div><div class="MsoNormal">That’s a little better, but still don’t like it. The alignment is wrong and I would like to see the dollar sign just to be clear that we are talking about money. Let tweak this a little bit.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-luYeBYJLcK4/UC7HM_-4NbI/AAAAAAAAATM/xAhkyQAarZQ/s1600/code-step-3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-luYeBYJLcK4/UC7HM_-4NbI/AAAAAAAAATM/xAhkyQAarZQ/s1600/code-step-3.png" /></a></div><div class="separator" style="clear: both; text-align: left;">And this is a nice formatted report:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-k9-VgHxm8TI/UC7HP9083_I/AAAAAAAAATs/KSsYOZUpMRE/s1600/step-3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-k9-VgHxm8TI/UC7HP9083_I/AAAAAAAAATs/KSsYOZUpMRE/s1600/step-3.png" /></a></div><div class="MsoNormal">Now I get the format I wanted but I'm not done yet. To finish this report I want to add some functionality, something that allows the user to click on the footer and see a detailed view of that info.</div><div class="MsoNormal"><br /></div><div class="MsoNormal">This is the code we need in order to add a link to the footer and finish our report:</div><div class="MsoNormal"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-ilmXQv3RAqA/UC7HNoibhSI/AAAAAAAAATU/eZObZMjN7_g/s1600/code-step-4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-ilmXQv3RAqA/UC7HNoibhSI/AAAAAAAAATU/eZObZMjN7_g/s1600/code-step-4.png" /></a></div><div class="MsoNormal"><br /></div><div class="MsoNormal">And this is the final result:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-RS0I7TTkRKs/UC7HQjdD7QI/AAAAAAAAAT0/zZHMSj3gAYc/s1600/step-4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-RS0I7TTkRKs/UC7HQjdD7QI/AAAAAAAAAT0/zZHMSj3gAYc/s1600/step-4.png" /></a></div><div class="MsoNormal">Now you can replace the message box with a useful report and you’re pretty much set ;)</div><div class="MsoNormal"><br /></div><br /><div class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span lang="EN-US"><span lang="EN-US"><span lang="EN-US"><span style="background-color: white;"><span style="background-color: white;">You can get the source code of NRapid from&nbsp;</span><a href="https://xp-dev.com/svn/NRapid/" style="background-color: white;" target="_blank">here</a></span></span></span></span></div><div class="MsoNormal"><span lang="EN-US"><span lang="EN-US"><span style="background-color: white;">And the sample app from&nbsp;</span><a href="https://xp-dev.com/svn/nrapid-reports-learn/" style="background-color: white;" target="_blank">here</a></span></span></div><div class="MsoNormal"><span lang="EN-US"><span lang="EN-US"><span lang="EN-US"><span style="background-color: white;"><span lang="EN-US"><span lang="EN-US">The Northwind database is available from download at&nbsp;<a href="http://www.microsoft.com/en-us/download/details.aspx?id=23654" target="_blank">http://www.microsoft.com/en-us/download/details.aspx?id=23654</a></span></span></span></span></span></span></div>