---           
layout: post
title: WinForms, how to implement conditional format for DataGridViews
date: 2013-01-02 22:25:09 UTC
updated: 2013-01-02 22:25:09 UTC
comments: false
categories: C# DataGridView WinForms
---
<br /><div class="MsoNormal"><span lang="EN-US">Being able to apply conditional formats to datagridviews is a must nowadays, users of our app probably make heavy use of this feature on Excel spreadsheets, and they want it to be present on any "grid alike" screen.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">I’ll show you two ways to implement this feature the first one is using pre-built formats, or formats specified in C# at compile time (better performance) and&nbsp;<b>the second one that allows users to add their own conditional formats with formulas written in an excel fashion</b>. In the last case the performance is not good enough for prod., but I’ll be sanding rough edges and hopefully make it work in a near future.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">To work on this feature, I'm going to use the same datagrid I used in the previous post, which you can download from <a href="https://github.com/amiralles/powergrid" target="_blank">here</a>.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">The whole functionality is already implemented, so I'll just show you how to use it.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">The only thing you have to do is register the conditional format and the component will take care of the rest.&nbsp;<o:p></o:p></span>To register a conditional format you have to specify a function (the conditional part) and the format to be applied if the function result is true. Something like this:</div><div class="MsoNormal"><span lang="EN-US"><o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-a-AYk0f9A3I/UOQ0pHfEsVI/AAAAAAAAAbw/jR9YqAL4uTc/s1600/setup-conditional-format.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-a-AYk0f9A3I/UOQ0pHfEsVI/AAAAAAAAAbw/jR9YqAL4uTc/s1600/setup-conditional-format.png" /></a></div><div class="MsoNormal"><span lang="EN-US">In order to apply all of the specified formats, we need to hook an event handler to the grid’s RowPrePaint event and evaluate each registered condition, if the result is true, the format is applied. (The component takes care of this; you don't have to do anything. It's just an implementation detail)<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-EpoGgFQapHI/UOQ0y6hcLpI/AAAAAAAAAb4/luTsbW1mKS4/s1600/on-prepaint.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-EpoGgFQapHI/UOQ0y6hcLpI/AAAAAAAAAb4/luTsbW1mKS4/s1600/on-prepaint.png" /></a></div><div class="MsoNormal"><span lang="EN-US">And this is the layout of our little sample.<o:p></o:p></span></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-oZUnWMpLNhE/UOQ06jh0pnI/AAAAAAAAAcA/AraaLOZuZuU/s1600/grid-layout.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-oZUnWMpLNhE/UOQ06jh0pnI/AAAAAAAAAcA/AraaLOZuZuU/s1600/grid-layout.png" /></a></div><div class="MsoNormal"><span lang="EN-US"><br /></span></div><div class="MsoNormal"><span lang="EN-US">In the next post, how to implement this behavior for user defined conditional formats.<o:p></o:p></span><br /><span lang="EN-US"><br /></span></div>